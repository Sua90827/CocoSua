<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.suamall.project.repository.CreditRepository">

	<insert id="insertCreditInfo"
		parameterType="com.suamall.project.dto.CreditInfoDTO">
		<selectKey order="BEFORE" keyProperty="credit_id"
			resultType="Integer">
			SELECT nvl(max(credit_id), 0) + 1 FROM sh_credit_info
		</selectKey>
		INSERT INTO sh_credit_info VALUES('${credit_id}','${user_id}','${prdt_id}','${prdt_price}','${prdt_amount}',
										'${credit_price}','${credit_way}','${order_nm}','${order_phone_num}',
										'${order_email}','${order_state}','${recipient_nm}','${recipient_phone_num}',
										'${recipient_zip_code}','${recipient_address}','${recipient_address_detail}',
										'${recipient_memo}',SYSTIMESTAMP)
	</insert>
	<select id="getPreviousAmount" resultType="com.suamall.project.dto.CartDTO">
		SELECT user_id, prdt_id, cart_amount FROM sh_cart_info WHERE user_id='${user_id}'
	</select>
	
	<update id="updateCartAmount" parameterType="com.suamall.project.dto.CartDTO">
		UPDATE sh_cart_info SET cart_amount = ${cart_amount} WHERE prdt_id=${prdt_id} AND user_id='${user_id}'
	</update>
	
	<delete id="deleteCartItem" parameterType="com.suamall.project.dto.CartDTO">
		DELETE FROM sh_cart_info WHERE user_id='${user_id}' AND prdt_id=${prdt_id}
	</delete>
</mapper>